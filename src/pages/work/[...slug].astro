---
import CaseStudyLayout from '../../layouts/CaseStudyLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
    const caseStudies = await getCollection('work');
    return caseStudies.map((entry) => ({
        params: { slug: entry.id },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

const schema = {
    "@context": "https://schema.org",
    "@graph": [
        {
            "@type": "CreativeWork",
            "name": entry.data.title,
            "description": entry.data.description,
            "url": `https://ced.ai/work/${entry.id}`,
            "author": {
                "@type": "Organization",
                "name": "ced.ai",
                "@id": "https://ced.ai/#organization"
            },
            "about": {
                "@type": "Thing",
                "name": entry.data.domain
            }
        },
        {
            "@type": "BreadcrumbList",
            "itemListElement": [
                { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://ced.ai" },
                { "@type": "ListItem", "position": 2, "name": "Case Studies", "item": "https://ced.ai/work" },
                { "@type": "ListItem", "position": 3, "name": entry.data.title, "item": `https://ced.ai/work/${entry.id}` }
            ]
        },
        {
            "@type": "FAQPage",
            "mainEntity": [
                {
                    "@type": "Question",
                    "name": `What is the ${entry.data.title} project?`,
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": entry.data.description
                    }
                }
            ]
        }
    ]
};
---

<CaseStudyLayout
    title={entry.data.title}
    description={entry.data.description}
    tag={entry.data.tag}
    tagColor={entry.data.tagColor}
    headline={entry.data.headline}
    metric={entry.data.metric}
    metricLabel={entry.data.metricLabel}
    techStack={entry.data.techStack}
    schema={schema}
>
    <Content />
</CaseStudyLayout>
